az group create --name openhack --location eastus
az aks create -g openhack -n openhackaks --location eastus --disable-rbac --generate-ssh-keys

az aks get-credentials --resource-group openhack --name openhackaks
az aks use-dev-spaces -g openhack -n openhackaks --space dev --yes

kubectl get svc -n kube-system --watch

az network dns record-set a add-record \
    --resource-group myResourceGroup \
    --zone-name eqslearning.com \
    --record-set-name *.traefik \
    --ipv4-address 52.149.202.131

kubectl apply --validate=false -f https://raw.githubusercontent.com/jetstack/cert-manager/release-0.12/deploy/manifests/00-crds.yaml --namespace kube-system
kubectl label namespace kube-system certmanager.k8s.io/disable-validation=true
helm repo add jetstack https://charts.jetstack.io
helm repo update
helm install cert-manager --namespace kube-system --version v0.12.0 jetstack/cert-manager --set ingressShim.defaultIssuerName=letsencrypt --set ingressShim.defaultIssuerKind=ClusterIssuer

kubectl apply -f letsencrypt-clusterissuer.yaml --namespace kube-system

helm upgrade traefik stable/traefik --namespace kube-system --set kubernetes.ingressClass=traefik --set kubernetes.ingressEndpoint.useDefaultPublishedService=true --version 1.85.0 --set ssl.enabled=true --set ssl.enforced=true --set ssl.permanentRedirect=true